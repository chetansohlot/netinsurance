{% extends 'master.html' %}

{% block title %}
    Members
{% endblock %}
  
{% block content %}
{% load static %}

<!-- Bootstrap CSS -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Bootstrap Bundle with Popper.js -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<body class="hold-transition sidebar-mini">
    <div class="wrapper">
        {% include 'navbar.html' %}

        {% include 'sidebar.html' %}
    
        <div class="content-wrapper white-bg">
            <div class="content-header header-content-bg mb-0">
              <div class="container-fluid">
                <div class="row justify-content-between justify-content-sm-start pb-4">
                  <div class="col col-sm-4">
                    <!-- <h1 class="admin-title m-0 py-2">View Member </h1> -->
                    <a href="#"><img src="{% static 'dist/img/svg/back_ic.svg' %}" alt="" class="mt-2 pl-3"></a>
                  </div>
                  <form id="activate-form" name="activate-form" method="post" action="{% url 'activate-user' user_id=user_details.id %}" style="display: none;">
                    {% csrf_token %}
                  </form>
                  
                  {% if user_details.activation_status != '1' %}
                    <div class="col">
                      <div class="d-flex justify-content-end mt-2">
                        <button class="dashboard-btn-outline mb-0" type="button" id="activate-btn" data-user-id="{{ user_details.id }}">Activate Account</button>
                      </div>  
                    </div>
                  {% endif %}
                  

                    <div class="col">
                        <div class="d-flex justify-content-end mt-2">
                            <button class="dashboard-btn-outline mb-0" type="button">Deactivate Membership</button>
                        </div>  
                    </div>
                </div>
              </div>
            </div>
            <!-- Main content -->
            <div class="content px-0">
                <div class="container-fluid">
                  <div class="row">
                    <div class="col-md-4 px-0">
                        <div class="card member-detail-left-card">
                            <div class="card-body box-profile">
                                <img src="{% static 'dist/img/svg/profile-avatar-male.svg' %}" alt="" class="card-profile-img">
                                <h3 class="profile-username text-center">{{ user_details.first_name }} {{ user_details.last_name }}</h3>
                                <div class="d-flex justify-content-center mt-2">
                                    
                                    {% if user_details.activation_status == '1' %}
                                        <p class="text-success">Active</p>
                                    {% else %}
                                        <p class="text-danger">Inactive</p>
                                    {% endif %}
                                </div>  
                                <div class="profile-info-divider"></div>
                                <ul class="member-detail-list">
                                    <li>
                                        <img src="dist/img/svg/gender_ic.svg" alt="">
                                        <span class="list">Gender</span>
                                        <span class="list-output">
                                            {% if user_details.gender == 1 %} Male {% elif user_details.gender == 2 %} Female {% else %} N/A {% endif %}
                                        </span>
                                    </li>
                                    <li>
                                        <img src="dist/img/svg/birthday_ic.svg" alt="">
                                        <span class="list">Date of birth</span>
                                        <span class="list-output">{{ user_details.dob }}</span>
                                    </li>
                                    <li>
                                        <img src="dist/img/svg/phone_ic.svg" alt="">
                                        <span class="list">Phone</span>
                                        <span class="list-output">{{ user_details.phone }}</span>
                                    </li>
                                    <li>
                                        <img src="dist/img/svg/email_ic.svg" alt="">
                                        <span class="list">E-mail</span>
                                        <span class="list-output">{{ user_details.email }}</span>
                                    </li>
                                    <li>
                                        <img src="dist/img/svg/membership-id_ic.svg" alt="">
                                        <span class="list">State</span>
                                        <span class="list-output">{{ user_details.state }}</span>
                                    </li>
                                    <li>
                                        <img src="dist/img/svg/activation-date_ic.svg" alt="">
                                        <span class="list">City</span>
                                        <span class="list-output">{{ user_details.city }}</span>
                                    </li>
                                    <li>
                                        <img src="dist/img/svg/activation-date_ic.svg" alt="">
                                        <span class="list">Pincode</span>
                                        <span class="list-output">{{ user_details.pincode }}</span>
                                    </li>
                                    <li>
                                        <img src="dist/img/svg/activation-date_ic.svg" alt="">
                                        <span class="list">Communication Address</span>
                                        <span class="list-output">{{ user_details.address }}</span>
                                    </li>
                                </ul>
                    
                                <!-- Edit Button -->
                                <button class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#editUserModal">Edit</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Edit Modal -->
                    <div class="modal fade" id="editUserModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <div class="modal-header">
                                    <h5 class="modal-title" id="editModalLabel">Edit User Details</h5>
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                </div>
                                <div class="modal-body">
                                    <form name="user-form" id="user-form" method="POST" action="{% url 'update-user-details' %}">
                                        {% csrf_token %}
                                        <div class="mb-3">
                                            <label for="editFirstName" class="form-label">First Name</label>
                                            <input type="text" class="form-control" id="editFirstName" name="first_name" value="{{ user_details.first_name }}">
                                        </div>
                                        <div class="mb-3">
                                            <label for="editLastName" class="form-label">Last Name</label>
                                            <input type="text" class="form-control" id="editLastName" name="last_name" value="{{ user_details.last_name }}">
                                        </div>
                                        <div class="mb-3">
                                            <label for="editEmail" class="form-label">E-mail</label>
                                            <input type="email" class="form-control" id="editEmail" name="email" value="{{ user_details.email }}">
                                        </div>
                                        <div class="mb-3">
                                            <label for="editPhone" class="form-label">Phone</label>
                                            <input type="text" class="form-control" id="editPhone" name="phone" value="{{ user_details.phone }}">
                                        </div>
                                        <div class="mb-3">
                                            <label for="editGender" class="form-label">Gender</label>
                                            <select class="form-control" id="editGender" name="gender">
                                                <option value="1" {% if user_details.gender == 1 %} selected {% endif %}>Male</option>
                                                <option value="2" {% if user_details.gender == 2 %} selected {% endif %}>Female</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label for="editDob" class="form-label">Date of Birth</label>
                                            <input type="date" class="form-control" id="editDob" name="dob" value="{{ user_details.dob }}">
                                        </div>
                                        <div class="mb-3">
                                            <label for="editState" class="form-label">State</label>
                                            <input type="text" class="form-control" id="editState" name="state" value="{{ user_details.state }}">
                                        </div>
                                        <div class="mb-3">
                                            <label for="editCity" class="form-label">City</label>
                                            <input type="text" class="form-control" id="editCity" name="city" value="{{ user_details.city }}">
                                        </div>
                                        <div class="mb-3">
                                            <label for="editPincode" class="form-label">Pincode</label>
                                            <input type="text" class="form-control" id="editPincode" name="pincode" value="{{ user_details.pincode }}">
                                        </div>
                                        <div class="mb-3">
                                            <label for="editAddress" class="form-label">Communication Address</label>
                                            <input type="text" class="form-control" id="editAddress" name="address" value="{{ user_details.address }}">
                                        </div>
                                        <button id="user-btn-sub" type="button" class="btn btn-success">Save Changes</button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                    

                    <div class="col-md-8 px-0">
                      <div class="card member-detail-right-card">
                        
                        <ul class="nav nav-pills profile-tab">
                            <li class="nav-item text-bold"><a class="nav-link active" href="#membership-tab" data-toggle="tab">Payout Details</a></li>
                            <li class="nav-item text-bold"><a class="nav-link" href="#organisation-tab" data-toggle="tab">Bank Details </a></li>
                            <li class="nav-item text-bold"><a class="nav-link" href="#personal-detail-tab" data-toggle="tab">Documents</a></li>
                        </ul>
                        
                        <!-- /.card-header -->
                        <div class="card-body">
                          <div class="tab-content tab-scrollbar">
                            <div class="active tab-pane" id="membership-tab">
                                <div class="row">
                                    <div class="col-md-12">
                                        <h1 class="card-hding mb-3 text-dark">Payout Details</h1>
                                        <table class="table table-bordered">
                                            <thead class="thead-light">
                                                <tr>
                                                    <th>Product</th>
                                                    <th>TP Prem. (%)</th>
                                                    <th>OD Prem. (%)</th>
                                                    <th>Net Prem. (%)</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr>
                                                    <td>Motor</td>
                                                    <td>5%</td>
                                                    <td>5%</td>
                                                    <td>5%</td>
                                                </tr>
                                                <tr>
                                                    <td>Health</td>
                                                    <td>6%</td>
                                                    <td>4%</td>
                                                    <td>5.5%</td>
                                                </tr>
                                                <tr>
                                                    <td>Term</td>
                                                    <td>7%</td>
                                                    <td>3%</td>
                                                    <td>6%</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                                
                            </div>
                            <div class="tab-pane" id="organisation-tab">
                                <!-- Personal Details -->
                                <div class="row mt-3">
                                    <div class="col-6 col-sm-6 col-md-4 col-lg-3">
                                        <div class="userdetail-group">
                                            <p class="userdetail-lbl">Account Holder Name</p>
                                            <p class="userdetail-highligt" id="accountHolderName">
                                                {% if bank_details %}
                                                    {{ bank_details.account_holder_name }}
                                                {% else %}
                                                    -
                                                {% endif %}
                                            </p>
                                        </div>
                                    </div>
                                    <div class="col-6 col-sm-6 col-md-4 col-lg-3">
                                        <div class="userdetail-group">
                                            <p class="userdetail-lbl">Re Enter Account Number</p>
                                            <p class="userdetail-highligt" id="reEnterAccountNumber">
                                                {% if bank_details %}
                                                    {{ bank_details.re_enter_account_number }}
                                                {% else %}
                                                    -
                                                {% endif %}
                                            </p>
                                        </div>
                                    </div>
                                    <div class="col-6 col-sm-6 col-md-4 col-lg-3">
                                        <div class="userdetail-group">
                                            <p class="userdetail-lbl">Account Number</p>
                                            <p class="userdetail-highligt" id="accountNumber">
                                                {% if bank_details %}
                                                    {{ bank_details.account_number }}
                                                {% else %}
                                                    -
                                                {% endif %}
                                            </p>
                                        </div>
                                    </div>
                                    <div class="col-6 col-sm-6 col-md-4 col-lg-3">
                                        <div class="userdetail-group">
                                            <p class="userdetail-lbl">IFSC Code</p>
                                            <p class="userdetail-highligt" id="ifscCode">
                                                {% if bank_details %}
                                                    {{ bank_details.ifsc_code }}
                                                {% else %}
                                                    -
                                                {% endif %}
                                            </p>
                                        </div>
                                    </div>
                                    <div class="col-6 col-sm-6 col-md-4 col-lg-3">
                                        <div class="userdetail-group">
                                            <p class="userdetail-lbl">City</p>
                                            <p class="userdetail-highligt" id="city">
                                                {% if bank_details %}
                                                    {{ bank_details.city }}
                                                {% else %}
                                                    -
                                                {% endif %}
                                            </p>
                                        </div>
                                    </div>
                                    <div class="col-6 col-sm-6 col-md-4 col-lg-3">
                                        <div class="userdetail-group">
                                            <p class="userdetail-lbl">State</p>
                                            <p class="userdetail-highligt" id="state">
                                                {% if bank_details %}
                                                    {{ bank_details.state }}
                                                {% else %}
                                                    -
                                                {% endif %}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                <!-- Edit Button -->
                                <button class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#editBankModal">Edit</button>
                            </div>
                            
                            
                                                            
                                                        <!-- Edit Modal -->
                            <div class="modal fade" id="editBankModal" tabindex="-1" aria-labelledby="editModalLabel" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="editModalLabel">Edit Payout Details</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <form name="bank-form" id="bank-form" method="POST" action="{% url 'store-bank-data' %}">
                                                {% csrf_token %}
                                                <div class="mb-3">
                                                    <label for="editAccountHolderName" class="form-label">Account Holder Name</label>
                                                    <input type="text" class="form-control" id="editAccountHolderName" name="account_holder_name"
                                                        value="{% if bank_details %}{{ bank_details.account_holder_name }}{% endif %}">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="editReEnterAccountNumber" class="form-label">Re Enter Account Number</label>
                                                    <input type="text" class="form-control" id="editReEnterAccountNumber" name="re_enter_account_number"
                                                        value="{% if bank_details %}{{ bank_details.re_enter_account_number }}{% endif %}">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="editAccountNumber" class="form-label">Account Number</label>
                                                    <input type="text" class="form-control" id="editAccountNumber" name="account_number"
                                                        value="{% if bank_details %}{{ bank_details.account_number }}{% endif %}">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="editIfscCode" class="form-label">IFSC Code</label>
                                                    <input type="text" class="form-control" id="editIfscCode" name="ifsc_code"
                                                        value="{% if bank_details %}{{ bank_details.ifsc_code }}{% endif %}">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="editCity" class="form-label">City</label>
                                                    <input type="text" class="form-control" id="editCity" name="city"
                                                        value="{% if bank_details %}{{ bank_details.city }}{% endif %}">
                                                </div>
                                                <div class="mb-3">
                                                    <label for="editState" class="form-label">State</label>
                                                    <input type="text" class="form-control" id="editState" name="state"
                                                        value="{% if bank_details %}{{ bank_details.state }}{% endif %}">
                                                </div>
                                                <button id="bank-btn-sub" type="button" class="btn btn-success">Save Changes</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <!-- /.tab-pane -->
                            <div class="tab-pane" id="personal-detail-tab">
                              <!-- Professional Detials -->
                              <div class="row mt-3">
                                
                                <div class="col-md-12">
                                  <hr>
                                  <h3 class="card-hding pt-3">Documents</h3>
                                </div>
                                <div class="col-6 col-sm-6 col-md-6 col-lg-6">
                                  <div class="family-info-card">
                                    <div class="row">
                                      <div class="col-auto">
                                        <div class="nametag">
                                          <img src="dist/img/aadhar-front.jpg" alt="">
                                        </div>
                                      </div>
                                      <div class="col">
                                        <h4 class="card-hding mb-0 pb-0">Aadhaar Card</h4>
                                        <div class="d-flex">
                                          <a href="#" class="wrap-small text-gray"><i class="fas fa-eye"></i> View Front </a>
                                          <a href="#" class="wrap-small text-gray ml-3"><i class="fas fa-eye"></i> View Back </a>
                                        </div>  
                                      </div>
                                    </div>
                                    <div class="row">
                                      <div class="col-sm-12">
                                        <hr>
                                        <div class="ml-3 pl-1">
                                          <p class="wrap-prgh font-weight-bold mb-0 pb-0">Aadhaar Number</p>
                                          <p class="wrap-small">7693 9033 1234</p>
                                        </div>  
                                      </div>
                                    </div>
                                  </div>
                                </div>
                                <div class="col-6 col-sm-6 col-md-6 col-lg-6">
                                  <div class="family-info-card">
                                    <div class="row">
                                      <div class="col-auto">
                                        <div class="nametag">
                                          <img src="dist/img/pan-card.webp" alt="">
                                        </div>
                                      </div>
                                      <div class="col">
                                        <h4 class="card-hding mb-0 pb-0">PAN Card</h4>
                                        <a href="#" class="wrap-small text-gray"><i class="fas fa-eye"></i> View Document</a>
                                      </div>
                                    </div>
                                    <div class="row">
                                      <div class="col-sm-12">
                                        <hr>
                                        <div class="ml-3 pl-1">
                                          <p class="wrap-prgh font-weight-bold mb-0 pb-0">PAN Number</p>
                                          <p class="wrap-small text-uppercase">BAXPK6214K</p>
                                        </div>  
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              <!-- /.Professional Detials -->
                            </div>
                            <!-- /.tab-pane -->
                            <div class="tab-pane" id="claims-tab">
                                <div class="row align-items-center mt-3 mb-3">
                                  <div class="col-md-auto">
                                    <h3 class="card-hding mb-0 pb-0">Claim History</h3>
                                  </div>
                                  <div class="col">
                                    <div class="d-flex justify-content-end">
                                      <a href="#" class="dashboard-btn-outline mx-2">Search Cashless Hospitals</a>
                                      <a href="#" class="dashboard-addbtn">Raise a Claim</a>
                                    </div>
                                  </div>
                                </div>  
                              <!-- Documents -->
                              <div class="table-responsive">
                                <table class="table table-design admin-table-design">
                                  <thead class="align-middle thead-light">
                                      <tr>
                                          <th>Claim ID/Type</th>
                                          <th>Patient Name/Relation</th>
                                          <th>Claim Status/Last Update On</th>
                                      </tr>
                                  </thead>
                                  <tbody>
                                    <tr>
                                      <td colspan="3">
                                        <div class="d-flex justify-content-center py-5">
                                          <div>
                                            <img src="dist/img/svg/drive.svg" alt="" class="mx-auto d-table">
                                            <p class="wrap-small text-gray text-center pt-2">No Data</p>
                                          </div>  
                                        </div>   
                                      </td>
                                    </tr>
                                  </tbody>
                                </table>                               
                               </div>    
                              <!-- /.Documents -->
                            </div>
                          </div>
                            <!-- /.tab-content -->
                        </div>
                      </div>
                    </div>
                  </div>  
                </div>
                
              </div>
            </div>
          </div>
        <!-- /.content-wrapper -->
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

        
        <script>
            // Add event listener to the button
            document.getElementById('activate-btn').addEventListener('click', function() {
              var userId = this.getAttribute('data-user-id');
              
              // Show SweetAlert confirmation
              Swal.fire({
                title: 'Are you sure?',
                text: "You are about to activate this account.",
                icon: 'warning',
                showCancelButton: true,
                confirmButtonText: 'Yes, activate it!',
                cancelButtonText: 'Cancel',
              }).then((result) => {
                if (result.isConfirmed) {
                  // Submit the hidden form
                  document.getElementById('activate-form').submit();
                  
                  // Show success message (optional)
                  Swal.fire(
                    'Activated!',
                    'The user account has been activated.',
                    'success'
                  );
                }
              });
            });
          </script>
          
        
    <script>
        document.getElementById('user-btn-sub').addEventListener('click', function(event) {
            event.preventDefault();  // Prevent default submit action
            document.getElementById('user-form').submit();  // Submit the user form
        });
        
        document.getElementById('bank-btn-sub').addEventListener('click', function(event) {
            event.preventDefault();  // Prevent default submit action
            document.getElementById('bank-form').submit();  // Submit the bank form
        });
    </script>
<script>
    function saveChanges() {
        document.getElementById('accountHolderName').innerText = document.getElementById('editAccountHolderName').value;
        document.getElementById('reEnterAccountNumber').innerText = document.getElementById('editReEnterAccountNumber').value;
        document.getElementById('accountNumber').innerText = document.getElementById('editAccountNumber').value;
        document.getElementById('ifscCode').innerText = document.getElementById('editIfscCode').value;
        document.getElementById('city').innerText = document.getElementById('editCity').value;
        document.getElementById('state').innerText = document.getElementById('editState').value;
    
        // Close Modal
        var modal = new bootstrap.Modal(document.getElementById('editModal'));
        modal.hide();
    }
    </script>
        {% include "footer.html" %}
    </div>
    <!-- ./wrapper -->
    
    {% include 'footer-script.html' %}
    
    
    
    
    </body>

{% endblock %}