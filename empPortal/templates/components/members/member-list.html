
{% load static %}

<div class="table-responsive table-ht">
    <table class="table table-design table-trlink">
      <thead class="table-thead-bg-light table-header-fix">
        <tr>
          <th width="10">
            <input type="checkbox" name="" id="checkall" class="table-chk">
            <label for="checkall"></label>
          </th>
          <th>Name / Employee ID</th>
          <th>Contact Details</th>
          <!-- <th>Role</th> -->
          <th>Member Status</th>
          {% if inexam %}
          <th>Exam Score & Status</th>
          <!-- <th>Certificate</th> -->
          {% endif  %}
          {% if inprocess %}
          <th>Doc Status</th>
          {% endif  %}
          <th width="50"></th>
        </tr>
      </thead>
      <tbody>
        {% for user in page_obj %}
          <tr>
            <td>
              <input type="checkbox" name="" id="check{{ user.id }}" class="table-chk">
              <label for="check{{ user.id }}"></label>
            </td>
            <td>
              <a href="{% url 'member-view' user_id=user.id %}" class="trlink">{{ user.full_name }} 
                <span class="text-gray d-block small">{{ user.user_gen_id }}</span>
              </a>
            </td>
            <td>
              {{ user.phone }} 
              <span class="text-gray d-block small">{{ user.email }}</span>
            </td>
            <!-- <td>{{ user.role_names }} <span class="text-gray d-block small">{{ user.status_type }}</span></td> -->
            <td>
                {% if user.partner.partner_status == '0' %}
                  <p class="text-warning">Requested</p>
                {% elif user.partner.partner_status == '1' %}
                  <p class="text-info">Document Verification</p>
                {% elif user.partner.partner_status == '2' %}
                  <p class="text-primary">In Training</p>
                {% elif user.partner.partner_status == '3' %}
                  <p class="text-secondary">In-Exam</p>
                {% elif user.partner.partner_status == '4' %}
                  {% if inexam %}
                    <p class="text-secondary">In-Exam</p>
                  {% else %}
                    <p class="text-success">Activated</p>
                  {% endif %}
                {% elif user.partner.partner_status == '5' %}
                  <p class="text-danger">Inactive</p>
                {% elif user.partner.partner_status == '6' %}
                  <p class="text-danger">Rejected</p>
                {% else %}
                  <p class="text-gray">Unknown Status</p>
                {% endif %}
              <span class="text-gray d-block small">{{ user.created_at|date:"d M 'y H:i:s" }} - Present</span>
            </td>

            {% if inprocess %}
            <td>
                {% if user.partner.doc_status|stringformat:"s" == '1' %}
                    <span class="badge bg-secondary">Doc Uploaded</span>
                {% elif user.partner.doc_status|stringformat:"s" == '2' %}
                    <span class="badge bg-info text-dark">In-Pending</span>
                {% elif user.partner.doc_status|stringformat:"s" == '3' %}
                    <span class="badge bg-success">Verified</span>
                {% else %}
                    <span class="badge bg-warning text-dark">Unknown Status</span>
                {% endif %}
                <span class="text-gray d-block small">{{ user.created_at|date:"d M 'y H:i:s" }} - Present</span>
            </td>
            {% endif %}

            {% if inexam %}
            <td>
              {% if user %}
                <span class="badge badge-success">
                  Score: {{ user.examRes.percentage|default:"Not Attempted" }}<br>
                  Status: {{ user.examRes.status|default:"Not Attempted" }}
                </span>
              {% else %}
                <span class="badge badge-secondary">N/A</span>
              {% endif %}
            </td>
            {% endif %}
              
            <td>
              <div class="dropdown">
                <img src="{% static 'dist/img/svg/menu-dot-vr.svg' %}" alt="" class="table-doticon" data-toggle="dropdown" aria-expanded="false">
                <ul class="dropdown-menu table-dropdown-menu">
                  <li><a class="dropdown-item" href="{% url 'member-view' user_id=user.id %}">View member</a></li>
                    {% if user.examRes %}
                      {% if intraining %}
                      <li><a class="dropdown-item" href="{% url 'download-training-certificate' user_id=user.id %}">Download Training Certificate</a></li>
                      {% endif %}


                      {% if inexam %}
                       <li><a class="dropdown-item" href="{% url 'download-certificate' user_id=user.id %}">Download Certificate</a></li>
                       <li><a class="dropdown-item" href="{% url 'download-training-certificate' user_id=user.id %}">Download Training Certificate</a></li>
                      {% endif %}
                    {% endif %}  
                

                </ul>
              </div>
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="7" class="text-center">No users found</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
  